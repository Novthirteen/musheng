Type.registerNamespace("AjaxControlToolkit");AjaxControlToolkit.ListSearchBehavior=function(d){var c=false,b=null,a=this;AjaxControlToolkit.ListSearchBehavior.initializeBase(a,[d]);a._promptCssClass=b;a._promptText=AjaxControlToolkit.Resources.ListSearch_DefaultPrompt;a._offsetX=0;a._offsetY=0;a._promptPosition=AjaxControlToolkit.ListSearchPromptPosition.Top;a._raiseImmediateOnChange=c;a._queryPattern=AjaxControlToolkit.ListSearchQueryPattern.StartsWith;a._isSorted=c;a._popupBehavior=b;a._onShowJson=b;a._onHideJson=b;a._originalIndex=0;a._newIndex=-1;a._showingPromptText=c;a._searchText="";a._ellipsis=String.fromCharCode(8230);a._binarySearch=c;a._applicationLoadDelegate=b;a._focusIndex=0;a._queryTimeout=0;a._timer=b;a._matchFound=c;a._focusHandler=b;a._blurHandler=b;a._keyDownHandler=b;a._keyUpHandler=b;a._keyPressHandler=b};AjaxControlToolkit.ListSearchBehavior.prototype={initialize:function(){var a=this;AjaxControlToolkit.ListSearchBehavior.callBaseMethod(a,"initialize");var b=a.get_element();if(b&&b.tagName==="SELECT"){a._focusHandler=Function.createDelegate(a,a._onFocus);a._blurHandler=Function.createDelegate(a,a._onBlur);a._keyDownHandler=Function.createDelegate(a,a._onKeyDown);a._keyUpHandler=Function.createDelegate(a,a._onKeyUp);a._keyPressHandler=Function.createDelegate(a,a._onKeyPress);$addHandler(b,"focus",a._focusHandler);$addHandler(b,"blur",a._blurHandler);$addHandler(b,"keydown",a._keyDownHandler);$addHandler(b,"keyup",a._keyUpHandler);$addHandler(b,"keypress",a._keyPressHandler);a._applicationLoadDelegate=Function.createDelegate(a,a._onApplicationLoad);Sys.Application.add_load(a._applicationLoadDelegate)}},dispose:function(){var a=this,b=a.get_element();$removeHandler(b,"keypress",a._keyPressHandler);$removeHandler(b,"keyup",a._keyUpHandler);$removeHandler(b,"keydown",a._keyDownHandler);$removeHandler(b,"blur",a._blurHandler);$removeHandler(b,"focus",a._focusHandler);a._onShowJson=null;a._onHideJson=null;a._disposePopupBehavior();if(a._applicationLoadDelegate){Sys.Application.remove_load(a._applicationLoadDelegate);a._applicationLoadDelegate=null}a._timer&&a._stopTimer();AjaxControlToolkit.ListSearchBehavior.callBaseMethod(a,"dispose")},_onApplicationLoad:function(){var b=false,a=AjaxControlToolkit.ListSearchBehavior.callBaseMethod(this,"get_ClientState");if(a!=null&&a!=""){b=a==="Focused";AjaxControlToolkit.ListSearchBehavior.callBaseMethod(this,"set_ClientState",null)}b&&this._handleFocus()},_checkIfSorted:function(d){if(this._isSorted)return true;else{for(var a=null,e=d.length,b=0;b<e;b++){var c=d[b].text.toLowerCase();if(a&&this._compareStrings(c,a)<0)return false;a=c}return true}},_onFocus:function(){this._handleFocus()},_handleFocus:function(){var a=this,b=a.get_element();a._focusIndex=b.selectedIndex;if(!a._promptDiv){a._promptDiv=document.createElement("div");a._promptDiv.id=b.id+"_promptDiv";a._promptDiv.innerHTML=a._promptText&&a._promptText.length>0?a._promptText:AjaxControlToolkit.Resources.ListSearch_DefaultPrompt;a._showingPromptText=true;if(a._promptCssClass)a._promptDiv.className=a._promptCssClass;b.parentNode.insertBefore(a._promptDiv,b.nextSibling);a._promptDiv.style.overflow="hidden";a._promptDiv.style.height=a._promptDiv.offsetHeight+"px";a._promptDiv.style.width=b.offsetWidth+"px"}if(!a._popupBehavior)a._popupBehavior=$create(AjaxControlToolkit.PopupBehavior,{parentElement:b},{},{},a._promptDiv);if(a._promptPosition&&a._promptPosition==AjaxControlToolkit.ListSearchPromptPosition.Bottom)a._popupBehavior.set_positioningMode(AjaxControlToolkit.PositioningMode.BottomLeft);else a._popupBehavior.set_positioningMode(AjaxControlToolkit.PositioningMode.TopLeft);a._onShowJson&&a._popupBehavior.set_onShow(a._onShowJson);a._onHideJson&&a._popupBehavior.set_onHide(a._onHideJson);a._popupBehavior.show();a._updatePromptDiv(a._promptText)},_onBlur:function(){var a=this;a._disposePopupBehavior();var b=a._promptDiv,c=a.get_element();if(b){a._promptDiv=null;b.parentNode.removeChild(b)}!a._raiseImmediateOnChange&&a._focusIndex!=c.selectedIndex&&a._raiseOnChange(c)},_disposePopupBehavior:function(){if(this._popupBehavior){this._popupBehavior.dispose();this._popupBehavior=null}},_onKeyDown:function(c){var a=this,b=a.get_element(),d=a._promptDiv;if(!b||!d)return;a._originalIndex=b.selectedIndex;if(a._showingPromptText){d.innerHTML="";a._searchText="";a._showingPromptText=false;a._binarySearch=a._checkIfSorted(b.options)}if(c.keyCode==Sys.UI.Key.backspace){c.preventDefault();c.stopPropagation();a._removeCharacterFromPromptDiv();a._searchForTypedText(b);(!a._searchText||a._searchText.length==0)&&a._stopTimer()}else if(c.keyCode==Sys.UI.Key.esc){c.preventDefault();c.stopPropagation();d.innerHTML="";a._searchText="";a._searchForTypedText(b);a._stopTimer()}else if(c.keyCode==Sys.UI.Key.enter&&!a._raiseImmediateOnChange&&a._focusIndex!=b.selectedIndex){a._focusIndex=b.selectedIndex;a._raiseOnChange(b)}},_onKeyUp:function(){var a=this,c=a.get_element(),b=a._promptDiv;if(!c||!b)return;if(a._newIndex==-1||!c||!b||b.innerHTML==""){a._newIndex=-1;return}c.selectedIndex=a._newIndex;a._newIndex=-1},_onKeyPress:function(b){var a=this,c=a.get_element(),d=a._promptDiv;if(!c||!d)return;if(!a._isNormalChar(b)){if(b.charCode==Sys.UI.Key.backspace){b.preventDefault();b.stopPropagation();a._searchText&&a._searchText.length==0&&a._stopTimer()}return}b.preventDefault();b.stopPropagation();a._addCharacterToPromptDiv(b.charCode);a._searchForTypedText(c);a._stopTimer();a._searchText&&a._searchText.length!=0&&a._startTimer()},_isNormalChar:function(a){if(Sys.Browser.agent==Sys.Browser.Firefox&&a.rawEvent.keyCode)return false;if(Sys.Browser.agent==Sys.Browser.Opera&&a.rawEvent.which==0)return false;if(a.charCode&&(a.charCode<Sys.UI.Key.space||a.charCode>6e3))return false;return true},_updatePromptDiv:function(f){var d=this,a=d._promptDiv;if(!a||!d.get_element())return;var b=typeof f==="undefined"?d._searchText:f,c=a.firstChild;if(!c){c=document.createTextNode(b);a.appendChild(c)}else c.nodeValue=b;if(a.scrollWidth<=a.offsetWidth&&a.scrollHeight<=a.offsetHeight)return;for(var e=b.length-1;e>0&&(a.scrollWidth>a.offsetWidth||a.scrollHeight>a.offsetHeight);e--)c.nodeValue=d._ellipsis+b.substring(b.length-e,b.length)},_addCharacterToPromptDiv:function(a){this._searchText+=String.fromCharCode(a);this._updatePromptDiv()},_removeCharacterFromPromptDiv:function(){var a=this;if(a._searchText&&a._searchText!=""){a._searchText=a._searchText.substring(0,a._searchText.length-1);a._updatePromptDiv()}},_searchForTypedText:function(c){var a=this,f=a._searchText,d=c.options,e=f?f.toLowerCase():"";a._matchFound=false;if(e.length==0){if(d.length>0){c.selectedIndex=0;a._newIndex=0}}else{var b=-1;if(a._binarySearch&&a._queryPattern==AjaxControlToolkit.ListSearchQueryPattern.StartsWith)b=a._doBinarySearch(d,e,0,d.length-1);else b=a._doLinearSearch(d,e,0,d.length-1);if(b==-1)a._newIndex=a._originalIndex;else{c.selectedIndex=b;a._newIndex=b;a._matchFound=true}}a._raiseImmediateOnChange&&a._originalIndex!=c.selectedIndex&&a._raiseOnChange(c)},_raiseOnChange:function(b){if(document.createEvent){var a=document.createEvent("HTMLEvents");a.initEvent("change",true,false);b.dispatchEvent(a)}else document.createEventObject&&b.fireEvent("onchange")},_compareStrings:function(a,b){return a==b?0:a<b?-1:1},_doBinarySearch:function(f,c,d,b){while(d<=b){var a=Math.floor((d+b)/2),g=f[a].text.toLowerCase().substring(0,c.length),e=this._compareStrings(c,g);if(e>0)d=a+1;else if(e<0)b=a-1;else{while(a>0&&f[a-1].text.toLowerCase().startsWith(c))a--;return a}}return -1},_doLinearSearch:function(b,d,e,c){if(this._queryPattern==AjaxControlToolkit.ListSearchQueryPattern.Contains){for(var a=e;a<=c;a++)if(b[a].text.toLowerCase().indexOf(d)>=0)return a}else if(this._queryPattern==AjaxControlToolkit.ListSearchQueryPattern.StartsWith)for(var a=e;a<=c;a++)if(b[a].text.toLowerCase().startsWith(d))return a;return -1},_onTimerTick:function(){var a=this;a._stopTimer();if(!a._matchFound){a._searchText="";a._updatePromptDiv()}},_startTimer:function(){var a=this;if(a._queryTimeout>0)a._timer=window.setTimeout(Function.createDelegate(a,a._onTimerTick),a._queryTimeout)},_stopTimer:function(){this._timer!=null&&window.clearTimeout(this._timer);this._timer=null},get_onShow:function(){return this._popupBehavior?this._popupBehavior.get_onShow():this._onShowJson},set_onShow:function(b){var a=this;if(a._popupBehavior)a._popupBehavior.set_onShow(b);else a._onShowJson=b;a.raisePropertyChanged("onShow")},get_onShowBehavior:function(){return this._popupBehavior?this._popupBehavior.get_onShowBehavior():null},onShow:function(){this._popupBehavior&&this._popupBehavior.onShow()},get_onHide:function(){return this._popupBehavior?this._popupBehavior.get_onHide():this._onHideJson},set_onHide:function(b){var a=this;if(a._popupBehavior)a._popupBehavior.set_onHide(b);else a._onHideJson=b;a.raisePropertyChanged("onHide")},get_onHideBehavior:function(){return this._popupBehavior?this._popupBehavior.get_onHideBehavior():null},onHide:function(){this._popupBehavior&&this._popupBehavior.onHide()},get_promptText:function(){return this._promptText},set_promptText:function(a){if(this._promptText!=a){this._promptText=a;this.raisePropertyChanged("promptText")}},get_promptCssClass:function(){return this._promptCssClass},set_promptCssClass:function(a){if(this._promptCssClass!=a){this._promptCssClass=a;this.raisePropertyChanged("promptCssClass")}},get_promptPosition:function(){return this._promptPosition},set_promptPosition:function(a){if(this._promptPosition!=a){this._promptPosition=a;this.raisePropertyChanged("promptPosition")}},get_raiseImmediateOnChange:function(){return this._raiseImmediateOnChange},set_raiseImmediateOnChange:function(a){if(this._raiseImmediateOnChange!=a){this._raiseImmediateOnChange=a;this.raisePropertyChanged("raiseImmediateOnChange")}},get_queryTimeout:function(){return this._queryTimeout},set_queryTimeout:function(a){if(this._queryTimeout!=a){this._queryTimeout=a;this.raisePropertyChanged("queryTimeout")}},get_isSorted:function(){return this._isSorted},set_isSorted:function(a){if(this._isSorted!=a){this._isSorted=a;this.raisePropertyChanged("isSorted")}},get_queryPattern:function(){return this._queryPattern},set_queryPattern:function(a){if(this._queryPattern!=a){this._queryPattern=a;this.raisePropertyChanged("queryPattern")}}};AjaxControlToolkit.ListSearchBehavior.registerClass("AjaxControlToolkit.ListSearchBehavior",AjaxControlToolkit.BehaviorBase);AjaxControlToolkit.ListSearchPromptPosition=function(){throw Error.invalidOperation();};AjaxControlToolkit.ListSearchPromptPosition.prototype={Top:0,Bottom:1};AjaxControlToolkit.ListSearchPromptPosition.registerEnum("AjaxControlToolkit.ListSearchPromptPosition");AjaxControlToolkit.ListSearchQueryPattern=function(){throw Error.invalidOperation();};AjaxControlToolkit.ListSearchQueryPattern.prototype={StartsWith:0,Contains:1};AjaxControlToolkit.ListSearchQueryPattern.registerEnum("AjaxControlToolkit.ListSearchQueryPattern");