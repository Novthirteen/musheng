Type.registerNamespace("AjaxControlToolkit.HTMLEditor");AjaxControlToolkit.HTMLEditor.Trim=function(a){return a.replace(/[\x00-\x1F]+/g,"")};AjaxControlToolkit.HTMLEditor.TrimAll=function(a){return a.replace(/[\x00-\x1F]/g,"").replace(/^[\x20]+/g,"").replace(/[\x20]+$/g,"")};AjaxControlToolkit.HTMLEditor.isIE=Sys.Browser.agent==Sys.Browser.InternetExplorer;AjaxControlToolkit.HTMLEditor.isSafari=Sys.Browser.agent==Sys.Browser.Safari;AjaxControlToolkit.HTMLEditor.isOpera=Sys.Browser.agent==Sys.Browser.Opera;AjaxControlToolkit.HTMLEditor.tryReplaceRgb=function(c){var a=c,e=/(rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\))/ig;function b(a){return a<16?"0"+a.toString(16):a.toString(16)}function d(h,i,a,c,d){var g=parseInt(a),f=parseInt(c),e=parseInt(d);return "#"+b(g)+b(f)+b(e)}try{a=a.replace(e,d)}catch(f){}return a};AjaxControlToolkit.HTMLEditor._getScrollTop=function(c){var a=c.document,b=0;if(typeof c.pageYOffset=="number")b=c.pageYOffset;if(a.body&&a.body.scrollTop)b=a.body.scrollTop;else if(a.documentElement&&a.documentElement.scrollTop)b=a.documentElement.scrollTop;return b};AjaxControlToolkit.HTMLEditor._getScrollLeft=function(c){var a=c.document,b=0;if(typeof c.pageXOffset=="number")b=c.pageXOffset;else if(a.body&&a.body.scrollLeft)b=a.body.scrollLeft;else if(a.documentElement&&a.documentElement.scrollLeft)b=a.documentElement.scrollLeft;return b};AjaxControlToolkit.HTMLEditor.addFormOnSubmit=function(e,d){var b="undefined",a=null,c=window.theForm;if(window.theForm!=a&&typeof window.theForm!=b){if(c.AjaxControlToolkit_HTMLEditor_editPanels==a||typeof c.AjaxControlToolkit_HTMLEditor_editPanels==b){c.originalOnSubmit_AjaxControlToolkit_HTMLEditor=window.theForm.onsubmit;c.AjaxControlToolkit_HTMLEditor_editPanels=[];window.theForm.onsubmit=AjaxControlToolkit.HTMLEditor.EditPanelsOnSubmit;if(window.__doPostBack!=a&&typeof window.__doPostBack!=b)if(window.__doPostBack_AjaxControlToolkit_HTMLEditor_original==a||typeof window.__doPostBack_AjaxControlToolkit_HTMLEditor_original==b){window.__doPostBack_AjaxControlToolkit_HTMLEditor_original=window.__doPostBack;window.__doPostBack=AjaxControlToolkit.HTMLEditor.EditPanelsOnPostBack}if(window.ValidatorGetValue!=a&&typeof window.ValidatorGetValue!=b)if(window.ValidatorGetValue_AjaxControlToolkit_HTMLEditor_original==a||typeof window.ValidatorGetValue_AjaxControlToolkit_HTMLEditor_original==b){window.ValidatorGetValue_AjaxControlToolkit_HTMLEditor_original=window.ValidatorGetValue;window.ValidatorGetValue=AjaxControlToolkit.HTMLEditor.ValidatorGetValue}}c.AjaxControlToolkit_HTMLEditor_editPanels.push({handler:e,editPanel:d})}};AjaxControlToolkit.HTMLEditor.removeFormOnSubmit=function(h){var c="undefined",b=null,a=window.theForm;if(window.theForm!=b&&typeof window.theForm!=c){var g=a.originalOnSubmit_AjaxControlToolkit_HTMLEditor;if(a.AjaxControlToolkit_HTMLEditor_editPanels!=b&&typeof a.AjaxControlToolkit_HTMLEditor_editPanels!=c){for(var e=[],d=0;d<a.AjaxControlToolkit_HTMLEditor_editPanels.length;d++){var f=a.AjaxControlToolkit_HTMLEditor_editPanels[d];f.handler!=h&&e.push(f)}a.AjaxControlToolkit_HTMLEditor_editPanels=e;if(a.AjaxControlToolkit_HTMLEditor_editPanels.length==0){window.theForm.onsubmit=g;a.originalOnSubmit_AjaxControlToolkit_HTMLEditor=b;a.AjaxControlToolkit_HTMLEditor_editPanels=b;if(window.__doPostBack_AjaxControlToolkit_HTMLEditor_original!=b&&typeof window.__doPostBack_AjaxControlToolkit_HTMLEditor_original!=c){window.__doPostBack=window.__doPostBack_AjaxControlToolkit_HTMLEditor_original;window.__doPostBack_AjaxControlToolkit_HTMLEditor_original=b}if(window.ValidatorGetValue_AjaxControlToolkit_HTMLEditor_original!=b&&typeof window.ValidatorGetValue_AjaxControlToolkit_HTMLEditor_original!=c){window.ValidatorGetValue=window.ValidatorGetValue_AjaxControlToolkit_HTMLEditor_original;window.ValidatorGetValue_AjaxControlToolkit_HTMLEditor_original=b}}}}};AjaxControlToolkit.HTMLEditor.EditPanelsOnSubmit=function(d){for(var a=window.theForm,c=true,b=0;b<a.AjaxControlToolkit_HTMLEditor_editPanels.length;b++){var c=a.AjaxControlToolkit_HTMLEditor_editPanels[b].handler(d);if(!c)break}if(c&&a.originalOnSubmit_AjaxControlToolkit_HTMLEditor!=null&&typeof a.originalOnSubmit_AjaxControlToolkit_HTMLEditor!="undefined")c=a.originalOnSubmit_AjaxControlToolkit_HTMLEditor(d);if(!c||!window.Page_IsValid)for(var b=0;b<a.AjaxControlToolkit_HTMLEditor_editPanels.length;b++)a.AjaxControlToolkit_HTMLEditor_editPanels[b].editPanel._contentPrepared=false;return c};AjaxControlToolkit.HTMLEditor.ValidatorGetValue=function(e){var c=null,a=$find(e);if(a!=c){var b=c;if(AjaxControlToolkit.HTMLEditor.Editor.isInstanceOfType(a))b=a.get_editPanel();else if(AjaxControlToolkit.HTMLEditor.EditPanel.isInstanceOfType(a))b=a;if(b!=c){var d=b._contentForValidation;if(d==c||typeof d=="undefined")d=b.get_content();return d}}return window.ValidatorGetValue_AjaxControlToolkit_HTMLEditor_original(e)};AjaxControlToolkit.HTMLEditor.EditPanelsOnPostBack=function(d,c){for(var b=window.theForm,a=0;a<b.AjaxControlToolkit_HTMLEditor_editPanels.length;a++){var e=b.AjaxControlToolkit_HTMLEditor_editPanels[a].handler(null);if(!e)return false}if(window.__doPostBack_AjaxControlToolkit_HTMLEditor_original!=null&&typeof window.__doPostBack_AjaxControlToolkit_HTMLEditor_original!="undefined")return window.__doPostBack_AjaxControlToolkit_HTMLEditor_original(d,c);return true};AjaxControlToolkit.HTMLEditor.getRealAttributeIE=function(e,f,g){var c="^(?:<[^>]*?",b=g,a="";function d(c,b){a=b}e.outerHTML.replace(new RegExp(c+f+'=")([^"]*?)"',"ig"),d);a==""&&e.outerHTML.replace(new RegExp(c+f+"=')([^']*?)'","ig"),d);a==""&&e.outerHTML.replace(new RegExp(c+f+"=)([^s>]*?)","ig"),d);if(b!=a&&a!=""){b=a;b=b.replace(/&amp;/g,"&")}return b};AjaxControlToolkit.HTMLEditor.getRealAttribute=function(d,b){var f=b.toLowerCase(),e=d.attributes,a="";for(i=0;i<e.length;++i){var c=e.item(i);if(!c.specified)continue;var b=c.name.toLowerCase();if(b==f){a=c.value;if(AjaxControlToolkit.HTMLEditor.isIE)a=AjaxControlToolkit.HTMLEditor.getRealAttributeIE(d,b,a);if(b=="src"||b=="href")a=a.replace(/(\(S\([A-Za-z0-9_]+\)\)\/)/,"");break}}return a};AjaxControlToolkit.HTMLEditor.enabledWordTags=["img","strong","p","b","i","u","a","h1","h2","h3","h4","h5","h6","table","tbody","tr","td","ul","ol","li","span","div","font","xml","del","ins","em","sub","sup","hr","br"];AjaxControlToolkit.HTMLEditor.cleanUp=function(f){var a="",c,b=AjaxControlToolkit.HTMLEditor.Trim(f.replace(/[\x00-\x1F]+/g," ")).replace(/^[^\u0000]+?<html(?:[^>]*?)>/gi,a).replace(/<\/html(?:[^>]*?)>[^\u0000]*$/gi,a).replace(/<head(?:[^>]*?)>[^\u0000]*?<\/head(?:[^>]*?)>/gi,a).replace(/<body[^>]*?>([^\u0000]*?)<\/body(?:[^>]*?)>/gi,"$1").replace(/<\/?html(?:[^>]*?)>/gi,a).replace(/<\/?head(?:[^>]*?)>/gi,a).replace(/<\/?body(?:[^>]*?)>/gi,a).replace(/<!--(\w|\W)+?-->/ig,a).replace(/(<[\/]?)(?:o|v|x|p|w|\?xml):(\w+)([^>]*?>)/ig,"$1$2$3").replace(/<(IMAGEDATA)([^>]*?)>/ig,"<img$2>").replace(/<p[^>]*><p>&nbsp;<\/p><\/p>/ig,"<br>").replace(/<p[^>]*?\/>/ig,a).replace(/<(p|div)[^>]*?>&nbsp;<\/(\1)[^>]*?>/ig,a).replace(/<(p|div)[^>]*?><\/(\1)[^>]*?>/ig,a);do{c=b;b=b.replace(/<([^>]*)(?:class|size|lang|face|start|type|border|[ovwxp]:\w+)=(?:\'[^\']*\'|\"[^\"]*\"|[^> ]+)([^>]*)>/ig,"<$1$2>")}while(b!=c);var d=document.createElement("div");d.innerHTML=b;function e(m){var h="solid",g="black",f="1px",d="height",c="width";for(var r=m.childNodes.length,i=0;i<m.childNodes.length;i++){var b=m.childNodes.item(i);if(b.nodeType==1)if(b.tagName.indexOf("/")>=0){i--;b.parentNode.removeChild(b)}else{for(var j=b.tagName.toLowerCase(),q=false,s=AjaxControlToolkit.HTMLEditor.enabledWordTags.length,n=0;n<s;n++)if(AjaxControlToolkit.HTMLEditor.enabledWordTags[n]==j){q=true;break}e(b);if(!q){i+=b.childNodes.length;while(b.firstChild)b.parentNode.insertBefore(b.firstChild,b);b.parentNode.removeChild(b);i--}else{var k=b.style.backgroundColor,l=b.style.color;b.style.cssText=a;b.removeAttribute("style");if(b.getAttribute(c)&&b.getAttribute(c).length>0)b.style.width=b.getAttribute(c);if(b.width&&b.width.length>0)b.style.width=b.width;b.width=a;try{b.removeAttribute(c)}catch(u){}if(b.getAttribute(d)&&b.getAttribute(d).length>0)b.style.height=b.getAttribute(d);if(b.height&&b.height.length>0)b.style.height=b.height;b.height=a;try{b.removeAttribute(d)}catch(u){}if(j=="table"){b.style.borderLeftWidth=f;b.style.borderLeftColor=g;b.style.borderLeftStyle=h;b.style.borderTopWidth=f;b.style.borderTopColor=g;b.style.borderTopStyle=h;b.style.backgroundColor=k;b.style.color=l}if(j=="td"){b.style.borderRightWidth=f;b.style.borderRightColor=g;b.style.borderRightStyle=h;b.style.borderBottomWidth=f;b.style.borderBottomColor=g;b.style.borderBottomStyle=h;b.style.backgroundColor=k;b.style.color=l}if(j=="font"||j=="span"){b.style.backgroundColor=k;b.style.color=l;for(var p=b.attributes,r=0,o=0;o<p.length;++o){var t=p.item(o);if(!t.specified)continue;r++}if(r==0&&b.style.cssText==a){i+=b.childNodes.length;while(b.firstChild)b.parentNode.insertBefore(b.firstChild,b);b.parentNode.removeChild(b);i--}}}}}}e(d);b=AjaxControlToolkit.HTMLEditor.Trim(d.innerHTML);delete d;b=b.replace(/<[\/]?(xml|del|ins)[^>]*?>/ig,a).replace(/<(p|div)[^>]*?>/ig,a).replace(/<\/(p|div)[^>]*?>/ig,"<br>");do{c=b;b=b.replace(/<b><\/b>/ig,a).replace(/<i><\/i>/ig,a).replace(/<u><\/u>/ig,a).replace(/<strong><\/strong>/ig,a).replace(/<em><\/em>/ig,a).replace(/<sub><\/sub>/ig,a).replace(/<sup><\/sup>/ig,a);b=b.replace(/<span[^>]*?><\/span>/ig,a).replace(/<span>([^<]+?)<\/span>/ig,"$1");b=b.replace(/<font[^>]*?><\/font>/ig,a).replace(/<font>([^<]+?)<\/font>/ig,"$1")}while(b!=c);b=b.replace(/&rsquo;/g,"'").replace(/&lsquo;/g,"'").replace(/&ndash;/g,"-").replace(/&mdash;/g,"-").replace(/&hellip;/g,"...").replace(/&quot;/g,'"').replace(/&ldquo;/g,'"').replace(/&rdquo;/g,'"').replace(//g,a).replace(/&bull;/g,a).replace(/[ \s]+/g," ").replace(/((&nbsp;)+)/g,"&nbsp;");if(document.all)b=b.replace(/^[\x00-\x1F]*&nbsp;/,a);return b};AjaxControlToolkit.HTMLEditor.spanJoiner=function(g,s,o,p,r){var l="SPAN",k="class",j=null,n="undefined",q=0,e=g.childNodes.length;if(typeof o!=n&&o!=j)q=o;if(typeof p!=n&&p!=j)e=p;for(var f=q;f<e&&f<g.childNodes.length;f++){var a=g.childNodes.item(f);if(a.parentNode!=g)continue;switch(a.nodeType){case 1:if(a.childNodes.length==0&&AjaxControlToolkit.HTMLEditor.isStyleTag(a.tagName)&&a.tagName.toUpperCase()!="A"&&!(a.className.length>0||a.getAttribute(k)&&a.getAttribute(k).length>0)&&!AjaxControlToolkit.HTMLEditor.isTempElement(a)){g.removeChild(a);f--;e--;continue}if(a.tagName.toUpperCase()==l){while(a.childNodes.length==1&&a.firstChild.nodeType==1){if(a.firstChild.tagName.toUpperCase()==l&&!AjaxControlToolkit.HTMLEditor.isTempElement(a.firstChild)){var h=AjaxControlToolkit.HTMLEditor.differAttr(a.firstChild,[]),d=AjaxControlToolkit.HTMLEditor.differStyle(a.firstChild),i=a.firstChild,w=i.childNodes;while(i.firstChild!=j)a.insertBefore(i.firstChild,i);for(var b=0;b<d.length;b++)if(d[b][1])try{if(a.style[d[b][0]])if(d[b][0].toLowerCase().indexOf("color")>=0)a.style[d[b][0]]=d[b][1];else try{var u=a.style[d[b][0]];a.style[d[b][0]]=a.style[d[b][0]]+" "+d[b][1];if(u==a.style[d[b][0]])a.style[d[b][0]]=d[b][1]}catch(x){a.style[d[b][0]]=d[b][1]}else a.style[d[b][0]]=d[b][1]}catch(x){}for(var b=0;b<h.length;b++)h[b][1]&&a.setAttribute(h[b][0],h[b][1]);a.removeChild(i);continue}else if(a.firstChild.tagName.toUpperCase()==l&&AjaxControlToolkit.HTMLEditor.isTempElement(a.firstChild)){var t=a.firstChild;a.parentNode.insertBefore(a.firstChild,a);a.parentNode.removeChild(a);a=t}break}var m=[],c=a.nextSibling;while(!AjaxControlToolkit.HTMLEditor.isTempElement(a)&&c&&f+1<e&&(c.nodeType==3||c.nodeType==1&&(c.tagName.toUpperCase()==l||c.tagName.toUpperCase()=="BR"&&typeof r==n)&&!AjaxControlToolkit.HTMLEditor.isTempElement(c)))if(c.nodeType==3)if((""+c.data+"").length==0){c.parentNode.removeChild(c);c=a.nextSibling;e--}else break;else if(c.tagName.toUpperCase()=="BR"){m.push(c);c=c.nextSibling}else{var h=AjaxControlToolkit.HTMLEditor.differAttr(a,[],c),d=AjaxControlToolkit.HTMLEditor.differStyle(a,c);if(h.length==0&&d.length==0&&a.className==c.className){for(var v=m.length,b=0;b<v;b++){a.appendChild(m[b]);e--}m=[];while(c.firstChild)a.appendChild(c.firstChild);c.parentNode.removeChild(c);c=a.nextSibling;e--}else break}if(!AjaxControlToolkit.HTMLEditor.isTempElement(a)&&a.className.length==0){var h=AjaxControlToolkit.HTMLEditor.differAttr(a,[]),d=AjaxControlToolkit.HTMLEditor.differStyle(a);if(h.length==0&&d.length==0){f--;e--;while(a.firstChild){a.parentNode.insertBefore(a.firstChild,a);e++}a.parentNode.removeChild(a);continue}}}if(a.parentNode!=j)if(a.childNodes.length==0&&AjaxControlToolkit.HTMLEditor.isStyleTag(a.tagName)&&a.tagName.toUpperCase()!="A"&&!(a.className.length>0||a.getAttribute(k)&&a.getAttribute(k).length>0)&&!AjaxControlToolkit.HTMLEditor.isTempElement(a)){g.removeChild(a);f--;e--;continue}else AjaxControlToolkit.HTMLEditor.spanJoiner(a,s)}}};AjaxControlToolkit.HTMLEditor._styleTags=["strong","em","u","strike","s","span","font","b","sub","sup","a","i"];AjaxControlToolkit.HTMLEditor.isStyleTag=function(b){if(!b)return false;for(var a=0;a<AjaxControlToolkit.HTMLEditor._styleTags.length;a++)if(AjaxControlToolkit.HTMLEditor._styleTags[a].toLowerCase()==b.toLowerCase())return true;return false};AjaxControlToolkit.HTMLEditor.smartClassName="AjaxControlToolkitMSIEparagraph";AjaxControlToolkit.HTMLEditor.noContextMenuAttribute="obout-no-contextmenu";AjaxControlToolkit.HTMLEditor.isTempElement=function(a){if(a.id&&a.id.length>0&&a.id.indexOf(AjaxControlToolkit.HTMLEditor.smartClassName)>=0)return true;return false};AjaxControlToolkit.HTMLEditor.differAttr=function(c,j,h){var d=[],b=c.parentNode;if(typeof h!="undefined")b=h;if(!b||!b.tagName||!AjaxControlToolkit.HTMLEditor.isStyleTag(b.tagName))b=null;if(c.attributes)for(var f=0;f<c.attributes.length;f++){for(var a=c.attributes[f],i=false,g=0;g<j.length;g++)if(a.name.toUpperCase()==j[g].toUpperCase()){i=true;break}if(i)continue;if(a.name.toUpperCase()=="STYLE")continue;if(a.name.toUpperCase().substr(0,4)=="_MOZ")continue;if(a.specified)if(b&&b.attributes&&b.attributes[a.name]){var e=b.attributes[a.name];if(e)(a.name!=e.name||a.value!=e.value)&&d.push([a.name,a.value])}else{if(a.name.toUpperCase()=="CLASS"&&a.value=="")continue;d.push([a.name,a.value])}}return d};AjaxControlToolkit.HTMLEditor.differStyle=function(e,l){var i="length",h="csstext",g="accelerator",f="string",m="undefined",k=[],d=e.parentNode;if(typeof l!=m)d=l;if(!d||!d.tagName||!AjaxControlToolkit.HTMLEditor.isStyleTag(d.tagName))d=null;function j(b,a){a=""+a;if(b.toLowerCase()=="textdecoration")for(var d=a.split(" "),c=0;c<d.length;c++)k.push([b,AjaxControlToolkit.HTMLEditor.Trim(d[c])]);else k.push([b,a])}for(var b in e.style)if(b&&typeof b==f&&b!=g){var a=b;if(!isNaN(parseInt(b))){if(!AjaxControlToolkit.HTMLEditor.isSafari)continue;a=e.style[b]}var c=e.style[a];if(c&&typeof c==f&&c!=g)if(d&&d.style){var n=d.style[a];if(a.toLowerCase()!=h&&a.toLowerCase()!=i)c!=n&&j(a,c)}else a.toLowerCase()!=h&&a.toLowerCase()!=i&&j(a,c)}if(typeof l!=m)for(var b in d.style)if(b&&typeof b==f&&b!=g){var a=b;if(!isNaN(parseInt(b))){if(!AjaxControlToolkit.HTMLEditor.isSafari)continue;a=e.style[b]}var c=d.style[a];if(c&&typeof c==f&&c!=g){var n=e.style[a];if(b.toLowerCase()!=h&&a.toLowerCase()!=i)c!=n&&j(a,c)}}return k};AjaxControlToolkit.HTMLEditor.brXHTML=function(a){return a.replace(/<br>/ig,"<br/>")};AjaxControlToolkit.HTMLEditor._needsClosingTag=function(b){var a=" script style div span a del strong em u strike font b sub sup p iframe li ul ol placeholder textarea td tr ";return a.indexOf(" "+b.tagName.toLowerCase()+" ")!=-1};AjaxControlToolkit.HTMLEditor._encodeText_=function(a){return a.replace(/&/ig,"&amp;").replace(/</ig,"&lt;").replace(/>/ig,"&gt;").replace(/\"/ig,"&quot;").replace(/\xA0/ig,"&nbsp;")};AjaxControlToolkit.HTMLEditor._noNeedsClosingTag=function(b){var a=" hr br ";return a.indexOf(" "+b.tagName.toLowerCase()+" ")!=-1};AjaxControlToolkit.HTMLEditor.canBeInsideP=function(b,e){var d="TABLE";if(b&&b.style&&b.style.display&&b.style.display.toLowerCase()=="inline")return true;var c=b.tagName.toUpperCase();if(c.length==2)if(c.substr(0,1)=="H"&&parseInt(c.substr(1,1))>0)return false;switch(c){case "TBODY":case "TR":case "TD":if(typeof e!="undefined"){var a=b.parentNode;while(a&&a.tagName&&a.tagName.toUpperCase()!=d)a=a.parentNode;if(a.tagName.toUpperCase()==d&&a.style&&a.style.display&&a.style.display.toLowerCase()=="inline")return true}case "P":case "PRE":case d:case "OL":case "UL":case "LI":case "HR":case "DIV":case "BLOCKQUOTE":case "FORM":case "FIELDSET":case "LEGEND":return false;default:return true}};AjaxControlToolkit.HTMLEditor.convertAlign=function(b){var a,c;try{c=parseInt(b)-1}catch(d){return b}switch(c){case 1:a="left";break;case 2:a="right";break;case 3:a="texttop";break;case 4:a="absmiddle";break;case 5:a="baseline";break;case 6:a="absbottom";break;case 7:a="bottom";break;case 8:a="middle";break;case 9:a="top";break;default:a=b.replace(/\"/g,"&quot;")}return a};AjaxControlToolkit.HTMLEditor.getHTML=function(a,b,d){try{if(typeof d=="undefined")if(!b&&a.nodeType==1)return a.innerHTML;else if(b&&a.nodeType==1&&AjaxControlToolkit.HTMLEditor.isIE)return a.outerHTML}catch(e){}var c=new AjaxControlToolkit.HTMLEditor.jsDocument(true);AjaxControlToolkit.HTMLEditor._getHTML_(c,a,b);return c.toString()};AjaxControlToolkit.HTMLEditor._getHTML_=function(c,a,v){var f='"',g="&quot;",e="",j=null,s="embed";switch(a.nodeType){case 1:case 11:if(a.tagName&&a.tagName.indexOf("/")>=0){if(AjaxControlToolkit.HTMLEditor.isIE){var h=a.tagName.toLowerCase().substr(a.tagName.indexOf("/")+1),o=a.previousSibling;if(h==s)return;while(o!=j){if(o.nodeType==a.nodeType&&o.tagName&&o.tagName.toLowerCase()==h){c.append("</teo"+AjaxControlToolkit.HTMLEditor.smartClassName+":"+a.tagName.toLowerCase().substr(a.tagName.indexOf("/")+1)+">");return}o=o.previousSibling}}return}var l,r,i;if(v&&a.tagName.length>0){var h=a.tagName.toLowerCase();l=!(a.hasChildNodes()||AjaxControlToolkit.HTMLEditor._needsClosingTag(a));r=true;var u=e;if(AjaxControlToolkit.HTMLEditor.isIE&&a.scopeName&&typeof a.scopeName!="undefined")u=a.scopeName.toUpperCase()=="HTML"?e:a.scopeName+":";if(AjaxControlToolkit.HTMLEditor.isIE&&(l||h=="placeholder")&&!AjaxControlToolkit.HTMLEditor._noNeedsClosingTag(a)&&h!=s){var n=a.nextSibling;while(n!=j){if(n.nodeType==a.nodeType&&n.tagName){var t=n.tagName;if(t.indexOf("/")>=0)if(t.toLowerCase().substr(t.indexOf("/")+1)==h){l=false;r=false;break}}n=n.nextSibling}}!AjaxControlToolkit.HTMLEditor.canBeInsideP(a)&&c.append("\n");c.append("<"+(!l&&!r?"teo"+AjaxControlToolkit.HTMLEditor.smartClassName+":":u)+h);AjaxControlToolkit.HTMLEditor.isIE&&a.name&&a.name.length>0&&c.append(' name="'+a.name.replace(/\"/g,g)+f);AjaxControlToolkit.HTMLEditor.isIE&&a.value&&a.value.length>0&&h!="textarea"&&c.append(' value="'+a.value.replace(/\"/g,g)+f);AjaxControlToolkit.HTMLEditor.isIE&&a.className&&a.className.length>0&&c.append(' class="'+a.className.replace(/\"/g,g)+f);AjaxControlToolkit.HTMLEditor.isIE&&a.align&&a.align.length>0&&c.append(' align="'+a.align.replace(/\"/g,g)+f);AjaxControlToolkit.HTMLEditor.isIE&&a.color&&a.color.length>0&&c.append(' color="'+a.color.replace(/\"/g,g)+f);AjaxControlToolkit.HTMLEditor.isIE&&a.size&&a.size.length>0&&a.size!="+0"&&c.append(' size="'+a.size.replace(/\"/g,g)+f);AjaxControlToolkit.HTMLEditor.isIE&&a.shape&&a.shape.length>0&&c.write(' shape="'+a.shape.replace(/\"/g,g)+f);AjaxControlToolkit.HTMLEditor.isIE&&a.coords&&a.coords.length>0&&c.write(' coords="'+a.coords.replace(/\"/g,g)+f);var w=a.attributes,q=j;for(i=0;i<w.length;++i){var p=w.item(i);if(!p.specified)continue;var d=p.name.toLowerCase();if(d.substr(0,4)=="_moz")continue;if(d=="teoalign")continue;var b;if(d!="style")if(d=="width"){b=a.width;if(AjaxControlToolkit.HTMLEditor.isIE&&b==0){var k=0;a.outerHTML.replace(new RegExp("^(?:<[^>]*?width=)([\\d]+)","ig"),function(b,a){k=a});if(b!=k)b=k}}else if(d=="height"){b=a.height;if(AjaxControlToolkit.HTMLEditor.isIE&&b==0){var k=0;a.outerHTML.replace(new RegExp("^(?:<[^>]*?height=)([\\d]+)","ig"),function(b,a){k=a});if(b!=k)b=k}}else if(AjaxControlToolkit.HTMLEditor.isIE&&d=="name"&&a.name&&a.name.length>0)continue;else if(AjaxControlToolkit.HTMLEditor.isIE&&d=="value"&&a.value&&a.value.length>0)continue;else if(AjaxControlToolkit.HTMLEditor.isIE&&d=="align"&&a.align&&a.align.length>0)continue;else if(AjaxControlToolkit.HTMLEditor.isIE&&d=="class"&&a.className&&a.className.length>0)continue;else if(AjaxControlToolkit.HTMLEditor.isIE&&d=="color"&&a.color&&a.color.length>0)continue;else if(AjaxControlToolkit.HTMLEditor.isIE&&d=="size"&&a.size&&a.size.length>0)continue;else if(AjaxControlToolkit.HTMLEditor.isIE&&d=="shape"&&a.shape&&a.shape.length>0)continue;else if(AjaxControlToolkit.HTMLEditor.isIE&&d=="coords"&&a.coords&&a.coords.length>0)continue;else if(h==s&&d=="align"&&AjaxControlToolkit.HTMLEditor.isIE)b=AjaxControlToolkit.HTMLEditor.convertAlign(p.value);else{b=p.value;if(AjaxControlToolkit.HTMLEditor.isSafari&&d=="class")if(/apple-style/ig.test(b))continue;if(d=="src"||d=="href"){if(AjaxControlToolkit.HTMLEditor.isIE)b=AjaxControlToolkit.HTMLEditor.getRealAttributeIE(a,d,b);b=b.replace(/(\(S\([A-Za-z0-9_]+\)\)\/)/,e)}b=b.replace(/\"/g,g)}else{if(AjaxControlToolkit.HTMLEditor.isSafari)q=p.value;continue}var m=f;if((e+b+e).indexOf(f)>=0)m="'";d!=j&&c.append(" "+d+"="+m+b+m)}if(a.style.cssText.length>0||q!=j){var d="style",z=/(url\((?:[^\)]*)\))/ig,y=[];function C(b,a){y.push(a)}var b=(q!=j?q:a.style.cssText).toLowerCase();b.replace(z,C);var x=0;function D(){var a=y[x];x++;return a}b=AjaxControlToolkit.HTMLEditor.tryReplaceRgb(b.replace(z,D)).replace(/(font-weight\s*:\s*)(700)/ig,"$1bold").replace(/([\s]*-moz-[^;]*[;][\s]*)/ig,e).replace(/(-moz-.*)$/i,e).replace(/(background-position: 0% 0%[;]*[\s]*)/ig,e);if(AjaxControlToolkit.HTMLEditor.isSafari){function B(d,a,b,c){return a+b.replace(/(,)/g,e)+c}b=b.replace(/(text-decoration:)([^;$]+)([;$])/ig,B)}if(AjaxControlToolkit.HTMLEditor.isSafari||AjaxControlToolkit.HTMLEditor.isOpera){function A(d,a,b,c){return a+b.replace(/(['"])/g,e)+c}b=b.replace(/(font-family:)([^;]+)([;]*)/ig,A)}if(b.length>0){var m=f;if((e+b+e).indexOf(f)>=0)m="'";c.append(" "+d+"="+m+b+m)}}c.append(l?" />":">");h=="br"&&c.append("\n")}a.tagName&&a.tagName.toUpperCase()=="SCRIPT"&&c.append(a.text);if(a.tagName&&a.tagName.toUpperCase()=="STYLE")c.append(a.innerHTML);else for(i=a.firstChild;i;i=i.nextSibling)AjaxControlToolkit.HTMLEditor._getHTML_(c,i,true);v&&a.tagName.length>0&&!l&&r&&c.append("</"+u+a.tagName.toLowerCase()+">");break;case 3:c.append(AjaxControlToolkit.HTMLEditor._encodeText_(e+a.data+e));break;case 8:if(a.length>0)c.append("<!--"+a.data+"-->");else c.append("<!---->")}};AjaxControlToolkit.HTMLEditor.RemoveContextMenu=function(){var a=this,b=a._contextElement.parentNode.removeChild(a._contextElement);if(b)delete b;a._contextElement=null;a._contextTable=null;if(a.__saved_range__){a.__saved_range__.select();a.__saved_range__=null}};AjaxControlToolkit.HTMLEditor.contentEditable=function(a,f){var e="undefined",b=null;while(a!=b){try{var c=b;if(a.contentEditable!=b&&typeof a.contentEditable!=e&&!(AjaxControlToolkit.HTMLEditor.isSafari||AjaxControlToolkit.HTMLEditor.isOpera))if(!a.contentEditable||a.contentEditable=="false")c=false;else c=true;else{var d=a.getAttribute("contenteditable");if(typeof d=="boolean")c=d;else if(typeof d=="string"&&d.toLowerCase()=="false")c=false}if(c!=b&&typeof c=="boolean")if(!c)return a}catch(g){}if(typeof f!=e&&f)return b;if(a.tagName!=b&&typeof a.tagName!=e&&(a.tagName.toUpperCase()=="BODY"||a.tagName.toUpperCase()=="HTML"))break;a=a.parentNode}return b};AjaxControlToolkit.HTMLEditor.getSelParent=function(c){var d=c._getSelection(),b=c._createRange(d),a=null;if(AjaxControlToolkit.HTMLEditor.isIE)if(d.type.toLowerCase()=="control")a=b.item(0);else a=c._getParent(b);else{a=c._getParent(b);if(a.nodeType!=3&&b.startContainer==b.endContainer){var e=a;a=a.childNodes.item(b.startOffset);if(a==null)a=e}}return a};AjaxControlToolkit.HTMLEditor.__getIndex=function(b){var a=0;if(b.parentNode)for(;a<b.parentNode.childNodes.length;a++)if(b.parentNode.childNodes.item(a)==b)break;return a};AjaxControlToolkit.HTMLEditor.isInlineElement=function(a){var b=false;if(a.nodeType==3)return true;if(a.nodeType!=1)return b;if(!a.tagName||a.tagName.length==0)return b;if(a&&a.style&&a.style.display&&a.style.display.toLowerCase()=="inline")return true;var c=a.tagName.toUpperCase();if(c.length==2)if(c.substr(0,1)=="H"&&parseInt(c.substr(1,1))>0)return b;switch(c){case "BR":case "TBODY":case "TR":case "TD":case "P":case "PRE":case "TABLE":case "OL":case "UL":case "LI":case "HR":case "DIV":case "BLOCKQUOTE":case "FORM":case "FIELDSET":case "LEGEND":return b;default:return true}};AjaxControlToolkit.HTMLEditor.capLock=function(b){var a=b.charCode,c=b.shiftKey?b.shiftKey:a==16?true:false;if(a>=65&&a<=90&&!c||a>=97&&a<=122&&c)return true;else return false};AjaxControlToolkit.HTMLEditor.operateAnchors=function(e,i,k){for(var h=i.getElementsByTagName("A"),j=false,f=0;f<h.length;f++){var a=h[f];if(a.name&&a.name.length>0){for(var d=[],g=0;g<a.childNodes.length;g++){var b=a.childNodes.item(g);if(b.nodeType==1&&b.tagName&&b.tagName.toUpperCase()=="IMG"&&b.src==e._editPanel.get_imagePath_anchor()){d.push(b);j=true}}while(d.length>0)a.removeChild(d.pop());if(!k){var c=i.createElement("IMG");c.title=a.name;c.src=e._editPanel.get_imagePath_anchor();c.setAttribute(e.noContextMenuAttributeName(),"yes");a.appendChild(c)}}}return j};AjaxControlToolkit.HTMLEditor.operatePlaceHolders=function(q,h,r){var n="undefined",m="PLACEHOLDER",l="placeholder",k="dummytag",o=false;if(r){for(var g=h.getElementsByTagName("IMG"),c=[],b=0;b<g.length;b++)c.push(g[b]);for(var b=0;b<c.length;b++){var a=c[b],i=a.getAttribute(k);if(i&&i.length>0&&i.toLowerCase()==l){var j=h.createElement(m),d=a.title;if(d==null||typeof d==n)d=a.getAttribute("title");j.name=d;j.setAttribute("name",d);a.parentNode.insertBefore(j,a);a.parentNode.removeChild(a);o=true}}}else{for(var g=h.getElementsByTagName(m),c=[],b=0;b<g.length;b++)c.push(g[b]);for(var b=0;b<c.length;b++){var a=c[b],p=true;try{if(a.childNodes.length>0)p=false}catch(s){}if(p){var e=a.name;if(e==null||typeof e==n)e=a.getAttribute("name");var f=h.createElement("IMG");f.title=e;f.src=q._editPanel.get_imagePath_placeHolder();f.setAttribute(k,l);f.setAttribute("title",e);a.parentNode.insertBefore(f,a);a.parentNode.removeChild(a)}}}return o};AjaxControlToolkit.HTMLEditor.inspectForShadows=function(e){var d="draggesture",c="dragstart";for(var b=e.getElementsByTagName("IMG"),a=0;a<b.length;a++)if(b[a].getAttribute(AjaxControlToolkit.HTMLEditor.attachedIdAttribute)&&b[a].getAttribute(AjaxControlToolkit.HTMLEditor.attachedIdAttribute).length>0){try{if(AjaxControlToolkit.HTMLEditor.isIE)$removeHandler(b[a],c,AjaxControlToolkit.HTMLEditor.stopDrag);else $removeHandler(b[a],d,AjaxControlToolkit.HTMLEditor.stopDrag)}catch(f){}if(AjaxControlToolkit.HTMLEditor.isIE)$addHandler(b[a],c,AjaxControlToolkit.HTMLEditor.stopDrag);else $addHandler(b[a],d,AjaxControlToolkit.HTMLEditor.stopDrag)}};AjaxControlToolkit.HTMLEditor.attachedIdAttribute="obout-attached-id";AjaxControlToolkit.HTMLEditor.stopDrag=function(a){a&&a.stopPropagation();a.preventDefault();return false};AjaxControlToolkit.HTMLEditor.replacingRules=[["strong","font-weight","bold"],["b","font-weight","bold"],["strong","font-weight","700"],["em","font-style","italic"],["i","font-style","italic"],["u","text-decoration","underline"],["strike","text-decoration","line-through"]];AjaxControlToolkit.HTMLEditor.replaceOldTags=function(c,h){var f="cssText";for(var k=c.innerHTML,l=false,d=0;d<AjaxControlToolkit.HTMLEditor.replacingRules.length;d++){var n=new RegExp("<"+AjaxControlToolkit.HTMLEditor.replacingRules[d][0]+"[s>]","ig");if(n.test(k)){l=true;break}}if(!l)if(!/<font[\s>]/ig.test(k))return;for(var i=0;i<c.childNodes.length;i++){var a=c.childNodes.item(i);if(a.nodeType==1){for(var e=null,j=a.tagName.toLowerCase(),d=0;d<AjaxControlToolkit.HTMLEditor.replacingRules.length;d++)if(AjaxControlToolkit.HTMLEditor.replacingRules[d][0].toLowerCase()==j){e=AjaxControlToolkit.HTMLEditor.replacingRules[d];break}if(e){var b=h._doc.createElement("SPAN");b.style[f]=a.style[f];if(AjaxControlToolkit.HTMLEditor.isIE)b.style[e[1]]=e[2];else b.style[e[1].replace(/\-(\w)/g,function(b,a){return a.toUpperCase()})]=e[2];while(a.firstChild)b.appendChild(a.firstChild);c.insertBefore(b,a);c.removeChild(a);a=b}else if(j=="font"){var b=h._doc.createElement("SPAN"),m=a.size;b.style[f]=a.style[f];if(a.color)b.style.color=a.color;if(a.face)b.style.fontFamily=a.face;while(a.firstChild)b.appendChild(a.firstChild);c.insertBefore(b,a);c.removeChild(a);if(m){var g=h._doc.createElement("FONT");g.size=m;c.insertBefore(g,b);if(b.style[f].length>0){g.appendChild(b);a=b}else{while(b.firstChild)g.appendChild(b.firstChild);c.removeChild(b);a=g}}else a=b}AjaxControlToolkit.HTMLEditor.replaceOldTags(a,h)}}};AjaxControlToolkit.HTMLEditor.getStyle=function(a,b){var c="";if(a.nodeType==1)if(a.ownerDocument&&a.ownerDocument.defaultView&&a.ownerDocument.defaultView.getComputedStyle)c=a.ownerDocument.defaultView.getComputedStyle(a,"").getPropertyValue(b);else if(a.currentStyle)try{b=b.replace(/\-(\w)/g,function(b,a){return a.toUpperCase()});c=a.currentStyle[b]}catch(d){c=a.style[b]}else c=a.style[b];return c};AjaxControlToolkit.HTMLEditor._Marker=function(c,d,f){var b=this;if(AjaxControlToolkit.HTMLEditor.isIE){b._nArr=AjaxControlToolkit.HTMLEditor.getNames(c._doc.body);b._save=c._doc.body.innerHTML;b._tree=null;if(f.type.toLowerCase()=="control")try{var a=d.item(0);b._tree=[];while(a&&(a.nodeType==3||!a.tagName||a.tagName.toUpperCase()!="BODY")){var e=0;while(a.previousSibling){e++;a=a.previousSibling}b._tree.push(e);a=a.parentNode}}catch(g){}else{b._offsetLeft=d.offsetLeft;b._offsetTop=d.offsetTop}}else{if(AjaxControlToolkit.HTMLEditor.isOpera)b._save=AjaxControlToolkit.HTMLEditor.Trim(c._doc.body.innerHTML);else b._save=c._doc.body.cloneNode(true);b._tree=[];b._offset=0;try{var a=d.startContainer;b._offset=d.startOffset;if(a&&a.nodeType==1&&a.tagName.toUpperCase()=="HTML"){a=c._doc.body;setTimeout(function(){try{f=c._getSelection();d=c._createRange();c._removeAllRanges(f);d.setStart(a,0);d.setEnd(a,0);c._selectRange(f,d)}catch(b){}},0)}while(a&&a.nodeType&&(a.nodeType==3||!a.tagName||a.tagName.toUpperCase()!="BODY")){var e=0;while(a.previousSibling){e++;if(AjaxControlToolkit.HTMLEditor.isOpera)if(a.nodeType==3&&a.previousSibling!=null&&a.previousSibling.nodeType==3)e--;a=a.previousSibling}b._tree.push(e);a=a.parentNode}}catch(g){}}};AjaxControlToolkit.HTMLEditor.__stackMaxSize=30;AjaxControlToolkit.HTMLEditor.getNames=function(i){for(var e=i.all,g=[],h=[],d=0;d<e.length;d++){var a=e[d];if(a.name&&a.name.length>0){for(var b=a.tagName,f=i.getElementsByTagName(b),j=0,c=0;c<f.length;c++)if(f[c]==a){j=c;break}h[b]=j;g.push([b,h[b],a.name])}}return g};AjaxControlToolkit.HTMLEditor.setNames=function(c,b){for(var a=0;a<b.length;a++)if(c.getElementsByTagName(b[a][0]).length>b[a][1])c.getElementsByTagName(b[a][0])[b[a][1]].name=b[a][2]};AjaxControlToolkit.HTMLEditor._lookChild=function(c,d){for(var a=0;a<c.childNodes.length;a++){var b=c.childNodes.item(a);if(b==d)return a;if(b.nodeType==1)if(AjaxControlToolkit.HTMLEditor._lookChild(b,d)>=0)return a}return -1};AjaxControlToolkit.HTMLEditor.getHrefsText=function(d){var a=[];function b(g,e,h,i,j,f){for(var d=e.replace(/^<([^\s>]+)/,"$1"),c=true,b=0;b<a.length;b++)if(a[b][0]==d){c=false;break}if(c)a[b]=[d];a[b].push(f)}var c=new RegExp("(<[^\\s><]+)([^><]*?)(href=)(\"|')([^\\4]*?)(\\4)((?:[^><]*?)>)","ig");d.replace(c,b);return a};AjaxControlToolkit.HTMLEditor.setHrefsText=function(g,d){for(var b=0;b<d.length;b++)for(var c=g.getElementsByTagName(d[b][0]),e=1,a=0;a<c.length;a++){if(!c[a].href)continue;if(d[b][e]&&d[b][e].length>0){var f;if(AjaxControlToolkit.HTMLEditor.isIE)f=c[a].innerHTML;c[a].href=d[b][e].replace(/&amp;/ig,"&");if(AjaxControlToolkit.HTMLEditor.isIE)c[a].innerHTML=f}e++}};AjaxControlToolkit.HTMLEditor.getImagesText=function(c){var a=[];function b(b,d,e,c){a.push(c);return b}c.replace(/(<img(?:.*?))(src=")(.*?)(")((?:.*?)>)/ig,b);return a};AjaxControlToolkit.HTMLEditor.setImagesText=function(e,d){for(var c=e.getElementsByTagName("IMG"),b=0,a=0;a<c.length;a++){if(!c[a].src)continue;if(d[b]&&d[b].length>0)c[a].src=d[b].replace(/&amp;/ig,"&");b++}};AjaxControlToolkit.HTMLEditor.canHaveChildren=function(a){if(AjaxControlToolkit.HTMLEditor.isIE)return a.canHaveChildren;else return !/^(area|base|basefont|col|frame|hr|img|br|input|isindex|link|meta|param)$/.test(a.tagName.toLowerCase())};AjaxControlToolkit.HTMLEditor._setCursor=function(j,a){var c=j;if(AjaxControlToolkit.HTMLEditor.isIE){var e=a._getSelection(),b=a._createRange(e);if(e.type.toLowerCase()=="control"){b.remove(0);e.empty();b=a._createRange()}var g=c.nodeType==3,d;if(g){d=a._doc.createElement("SPAN");d.innerHTML="&nbsp;";c.parentNode.insertBefore(d,c);c=d}var f=$common.getLocation(c),h=f.x,i=f.y;g&&d.parentNode.removeChild(d);try{b.moveToPoint(h,i)}catch(k){}b.select()}else{var e=a._getSelection(),b=a._createRange();b.setStart(c,0);b.setEnd(c,0);a._removeAllRanges(e);a._selectRange(e,b);a.focusEditor()}};AjaxControlToolkit.HTMLEditor.myClone=function(a,e,d){var b;if(AjaxControlToolkit.HTMLEditor.isIE&&a.tagName&&(a.tagName.toUpperCase()=="EMBED"||a.tagName.toUpperCase()=="OBJECT")){var c=e.createElement("DIV");try{c.innerHTML=a.outerHTML;b=c.firstChild}catch(f){b=a}delete c}else b=a.cloneNode(d);return b};AjaxControlToolkit.HTMLEditor.unStyle=function(a){var k="function",f=false,b=null,c=a.parentNode!=b&&typeof a.parentNode!="undefined"?a.parentNode:b;if(c){var d=b;while(c&&c.tagName&&c.tagName.toUpperCase()!="BODY"&&AjaxControlToolkit.HTMLEditor.isStyleTag(c.tagName)&&c.tagName.toUpperCase()!="A"){d=c;c=c.parentNode}if(d){function j(g,c,h,i,l){var a=h.cloneNode(f);if(g)if(g.push&&typeof g.push==k)for(var n=0;n<g.length;n++)a.appendChild(g[n]);else a.appendChild(g);if(l)a.appendChild(c);else while(c){var q=i?c.previousSibling:c.nextSibling;if(c.nodeType==1||c.nodeType==3&&AjaxControlToolkit.HTMLEditor.Trim(""+c.data+"").length>0){if(c.nodeType==1)if(c.tagName&&AjaxControlToolkit.HTMLEditor.isStyleTag(c.tagName)&&c.childNodes.length==0&&!AjaxControlToolkit.HTMLEditor.isTempElement(c))c=b;if(c)if(a.childNodes.length==0||!i)a.appendChild(c);else a.insertBefore(c,a.firstChild)}c=q}if(a.childNodes.length==0){delete a;a=b}else if(a.childNodes.length==1&&a.firstChild.nodeType==3&&(""+a.firstChild.data+"").length==0){delete a;a=b}else if(!l&&a.tagName&&AjaxControlToolkit.HTMLEditor.isStyleTag(a.tagName)&&a.tagName.toUpperCase()!="A"&&!AjaxControlToolkit.HTMLEditor.isTempElement(a)){for(var o=a.childNodes.length,m=0;m<a.childNodes.length;m++){var e=a.childNodes.item(m);if(e.nodeType==1&&e.tagName&&!AjaxControlToolkit.HTMLEditor.isStyleTag(e.tagName)&&(e.tagName.toUpperCase()=="BR"||e.tagName.toUpperCase()=="TABLE"||AjaxControlToolkit.HTMLEditor.isTempElement(e)))o--}if(o==0){var p=[];while(a.firstChild){var e=a.removeChild(a.firstChild);p.push(e)}a=p}}if(h==d)return a;else if(!l)return j(a,i?h.previousSibling:h.nextSibling,h.parentNode,i,l);else return j(b,a,h.parentNode,i,l)}c=a.parentNode;if(a.previousSibling==b&&a.nextSibling==b&&c&&c.tagName&&c.tagName.toUpperCase()!="BODY"&&AjaxControlToolkit.HTMLEditor.isStyleTag(c.tagName)&&AjaxControlToolkit.HTMLEditor.differAttr(c,["class","color","face","size"]).length>0)a=c;var h=j(b,a.previousSibling,a.parentNode,true,f),i=j(b,a.nextSibling,a.parentNode,f,f),e=d.parentNode;if(h)if(h.push&&typeof h.push==k)for(var g=0;g<h.length;g++)e.insertBefore(h[g],d);else e.insertBefore(h,d);if(a.nodeType==1&&a.tagName&&(a.tagName.toUpperCase()=="BR"||a.tagName.toUpperCase()=="TABLE"||AjaxControlToolkit.HTMLEditor.isTempElement(a)))e.insertBefore(a,d);else{var l=j(b,a,a.parentNode,f,true);e.insertBefore(l,d)}if(i)if(i.push&&typeof i.push==k)for(var g=0;g<i.length;g++)e.insertBefore(i[g],d);else e.insertBefore(i,d);e.removeChild(d)}}};AjaxControlToolkit.HTMLEditor.isTempElement=function(a){if(a.id&&a.id.length>0&&a.id.indexOf(AjaxControlToolkit.HTMLEditor.smartClassName)>=0)return true;return false};AjaxControlToolkit.HTMLEditor._moveTagsUp=function(d,e){function b(a){if(!AjaxControlToolkit.HTMLEditor.isInlineElement(a)||a.nodeType==3)AjaxControlToolkit.HTMLEditor.unStyle(a);else if(a.tagName&&AjaxControlToolkit.HTMLEditor.isStyleTag(a.tagName)&&a.tagName.toUpperCase()!="A"&&!AjaxControlToolkit.HTMLEditor.isTempElement(a)){var c=a.firstChild;while(c!=null){var d=c.nextSibling;b(c);c=d}}}var a=d;while(a!=null&&a!=e){var c=a.nextSibling;b(a);a=c}};AjaxControlToolkit.HTMLEditor._commonTotalParent=function(e,g){var h=null,a=e.parentNode,f=e;while(a){if(a.tagName&&!AjaxControlToolkit.HTMLEditor.isStyleTag(a.tagName)){var d=AjaxControlToolkit.HTMLEditor._lookChild(a,g);if(d>=0){for(var c=0,b=0;b<a.childNodes.length;b++)if(a.childNodes.item(b)==f){c=b;break}return {parent:a,indexFirst:c,indexLast:d}}}f=a;a=a.parentNode}return h};AjaxControlToolkit.HTMLEditor._commonParent=function(e,g){var h=null,a=e.parentNode,f=e;while(a&&a.tagName.toUpperCase()!="BODY"&&AjaxControlToolkit.HTMLEditor.isStyleTag(a.tagName)){var d=AjaxControlToolkit.HTMLEditor._lookChild(a,g);if(d>=0){for(var c=0,b=0;b<a.childNodes.length;b++)if(a.childNodes.item(b)==f){c=b;break}return {parent:a,indexFirst:c,indexLast:d}}f=a;a=a.parentNode}return h};AjaxControlToolkit.HTMLEditor.positionInParagraph=function(b,e,c,a,f){while(true){var d=AjaxControlToolkit.HTMLEditor.positionInParagraphLevel(b,e,c,f);if(d!=null)return d;if(a.tagName&&AjaxControlToolkit.HTMLEditor.isStyleTag(a.tagName)&&a.tagName.toUpperCase()!="A"&&!AjaxControlToolkit.HTMLEditor.isTempElement(a)){e=c?a.previousSibling:a.nextSibling;a=a.parentNode}else{if(!c||a.firstChild==null)a.appendChild(b);else a.insertBefore(b,a.firstChild);return b}}};AjaxControlToolkit.HTMLEditor.positionInParagraphLevel=function(c,a,d,g){while(a){var j=d?a.previousSibling:a.nextSibling;if(!AjaxControlToolkit.HTMLEditor.isInlineElement(a)){var e=a.parentNode;if(!d)e.insertBefore(c,a);else if(a.nextSibling)e.insertBefore(c,a.nextSibling);else e.appendChild(c);return c}else if(typeof g=="function"&&a.nodeType==3){var b,f=""+a.data+"";if(d){for(b=f.length-1;b>=0;b--)if(g(f.substr(b,1)))break}else for(b=0;b<f.length;b++)if(g(f.substr(b,1)))break;if(b>=0&&b<f.length){var e=a.parentNode,h;if((b>0||d&&b==0)&&(b<f.length-1||!d&&b==f.length-1)){if(d)h=a.splitText(b+1);else h=a.splitText(b);e.insertBefore(c,h)}else if(!d)e.insertBefore(c,a);else if(a.nextSibling)e.insertBefore(c,a.nextSibling);else e.appendChild(c);return c}}a=d?a.lastChild:a.firstChild;if(a){var i=AjaxControlToolkit.HTMLEditor.positionInParagraphLevel(c,a,d,g);if(i!=null)return i}a=j}return null};AjaxControlToolkit.HTMLEditor._addEvent=function(a,b,c){if(a.attachEvent)a.attachEvent("on"+b,c);else a.addEventListener&&a.addEventListener(b,c,true)};AjaxControlToolkit.HTMLEditor._addEvents=function(d,b,c){for(var a=0;a<b.length;a++)AjaxControlToolkit.HTMLEditor._addEvent(d,b[a],c)};AjaxControlToolkit.HTMLEditor._removeEvent=function(a,b,c){if(a.detachEvent)a.detachEvent("on"+b,c);else a.removeEventListener&&a.removeEventListener(b,c,true)};AjaxControlToolkit.HTMLEditor._removeEvents=function(d,b,c){for(var a=0;a<b.length;a++)AjaxControlToolkit.HTMLEditor._removeEvent(d,b[a],c)};AjaxControlToolkit.HTMLEditor._stopEvent=function(a){if(a)if(AjaxControlToolkit.HTMLEditor.isIE){a.cancelBubble=true;a.returnValue=false}else{a.preventDefault();a.stopPropagation()}};AjaxControlToolkit.HTMLEditor.restrictedTags=["DIV","P","TD","TR","TABLE","TBODY","LI","OL","UL","FORM","INPUT"];AjaxControlToolkit.HTMLEditor.isRestricted=function(b){for(var c=b.tagName.toUpperCase(),a=0;a<AjaxControlToolkit.HTMLEditor.restrictedTags.length;a++)if(AjaxControlToolkit.HTMLEditor.restrictedTags[a].toUpperCase()==c)return true;if(AjaxControlToolkit.HTMLEditor.isIE&&b.scopeName.toUpperCase()!="HTML")return true;return false};AjaxControlToolkit.HTMLEditor.jsDocument=function(c){var a="\n",b=this;b.noExtraLf=typeof c!="undefined"&&c;b.text=[];b.write=function(c){var b=this;if(!b.noExtraLf||b.text.length==0&&c!=a||b.text.length>0&&(b.text[b.text.length-1]!=a||c!=a))b.text[b.text.length]=c};b.append=b.write;b.writeln=function(b){this.text[this.text.length]=b+a};b.toString=function(){return this.text.join("")};b.clear=function(){delete this.text;this.text=null;this.text=[]}};AjaxControlToolkit.HTMLEditor.isHeader=function(b){var a=b.tagName.toUpperCase();if(a.length==2)if(a.substr(0,1)=="H"&&parseInt(a.substr(1,1))>0)return true;return false};AjaxControlToolkit.HTMLEditor._getReallyFirst=function(a){var b="undefined";if(typeof a.firstChild!=b&&a.firstChild!=null)if(typeof a.firstChild.childNodes!=b&&a.firstChild.childNodes!=null)return AjaxControlToolkit.HTMLEditor._getReallyFirst(a.firstChild);return a};AjaxControlToolkit.HTMLEditor._getReallyLast=function(a){var b="undefined";if(typeof a.lastChild!=b&&a.lastChild!=null)if(typeof a.lastChild.childNodes!=b&&a.lastChild.childNodes!=null)return AjaxControlToolkit.HTMLEditor._getReallyLast(a.lastChild);return a};AjaxControlToolkit.HTMLEditor._reallyFirst=function(a,b){if(a.firstChild){if(a.firstChild==b)return true;if(a.firstChild.childNodes)if(AjaxControlToolkit.HTMLEditor._lookChild(a.firstChild,b)==0)return AjaxControlToolkit.HTMLEditor._reallyFirst(a.firstChild,b)}return false};AjaxControlToolkit.HTMLEditor._reallyLast=function(a,b){if(a.lastChild){if(a.lastChild==b)return true;if(a.lastChild.childNodes)if(AjaxControlToolkit.HTMLEditor._lookChild(a.lastChild,b)==a.lastChild.childNodes.length-1)return AjaxControlToolkit.HTMLEditor._reallyLast(a.lastChild,b)}return false};AjaxControlToolkit.HTMLEditor.getContainer=function(b,c){if(c==b)return b;if(b.nodeType==1)for(var d=0;d<b.childNodes.length;d++){var a=b.childNodes.item(d);if(c==a)return a;if(a.nodeType==1){var e=AjaxControlToolkit.HTMLEditor._lookChild(a,c);if(e>=0)if(a.tagName&&AjaxControlToolkit.HTMLEditor.isStyleTag(a.tagName)&&a.tagName.toUpperCase()!="A"&&!AjaxControlToolkit.HTMLEditor.isTempElement(a))return AjaxControlToolkit.HTMLEditor.getContainer(a,c);else return a}}return null};AjaxControlToolkit.HTMLEditor._TryTransformFromPxToPt=function(h,f,g){var c=h.replace(/^(\d+)\.(\d+)px/i,"$1px");if(!AjaxControlToolkit.HTMLEditor.isIE)if(c&&c.length>0){var d=c.toLowerCase().split(",")[0];if(typeof g!="undefined"){var e=document.getElementById(g);if(e!=null){for(var a=0;a<e.options.length;a++){var i=AjaxControlToolkit.HTMLEditor.fontSizeSeek(e.options.item(a).value.toLowerCase().split(",")[0]);if(i==d)break}if(a==e.options.length){var b=f._doc.createElement("SPAN");f._doc.body.appendChild(b);for(a=1;a<100;a++){b.style.fontSize=a+"pt";if(AjaxControlToolkit.HTMLEditor.getStyle(b,"font-size").replace(/^(\d+)\.(\d+)px/i,"$1px")==d){d=a+"pt";break}}b.parentNode.removeChild(b)}}}c=d}return c};AjaxControlToolkit.HTMLEditor.fontSizeSeek=function(b){var a=b.toString();switch(a){case "1":a="8pt";break;case "2":a="10pt";break;case "3":a="12pt";break;case "4":a="14pt";break;case "5":a="18pt";break;case "6":a="24pt";break;case "7":a="36pt"}return a};AjaxControlToolkit.HTMLEditor.getOwnerDocument=function(a){return a.nodeType==9?a:a.ownerDocument||a.document};AjaxControlToolkit.HTMLEditor.getClientViewportElement=function(b){var a;if(b.nodeType==9)a=b;else a=AjaxControlToolkit.HTMLEditor.getOwnerDocument(b);if(AjaxControlToolkit.HTMLEditor.isIE&&a.compatMode!="CSS1Compat")return a.body;return a.documentElement};AjaxControlToolkit.HTMLEditor.isReallyVisible=function(c){var a=c,b=true;while(a){if(a.style&&AjaxControlToolkit.HTMLEditor.getStyle(a,"display")=="none"){b=false;break}a=a.parentNode}return b};AjaxControlToolkit.HTMLEditor.setSelectionRange=function(a,c,e){var d="character";a.focus();if(a.setSelectionRange)a.setSelectionRange(c,e);else if(a.createTextRange){var b=a.createTextRange();b.collapse(true);b.moveEnd(d,e);b.moveStart(d,c);b.select()}};AjaxControlToolkit.HTMLEditor.setElementVisibility=function(e){var d=[],a=e;while(a&&a.nodeType==1&&a.tagName.toUpperCase()!="BODY"){var c=a.style.display,b=a.style.visibility;if(a.style&&(c=="none"||b=="hidden")){d.push({element:a,display:c,visibility:b});a.style.display="";a.style.visibility="visible"}a=a.parentNode}return d};AjaxControlToolkit.HTMLEditor.restoreElementVisibility=function(d){for(var b=0;b<d.length;b++){var a=d[b],c=a.element.style;c.display=a.display;c.visibility=a.visibility}};if(!AjaxControlToolkit.HTMLEditor.isIE)try{AjaxControlToolkit.HTMLEditor.__MozillaGetInnerText=function(g,b){for(var d=g.childNodes,c=0;c<d.length;c++){var a=d[c];a.nodeType==3&&b.write(a.nodeValue.replace("\n",""));if(a.nodeType==1){var f=AjaxControlToolkit.HTMLEditor.getStyle(a,"display"),e=AjaxControlToolkit.HTMLEditor.getStyle(a,"visibility");AjaxControlToolkit.HTMLEditor.__needLineBreakBefore(a)&&b.write("\n");AjaxControlToolkit.HTMLEditor.__needTabBefore(a)&&b.write("\t");f!="none"&&e!="hidden"&&AjaxControlToolkit.HTMLEditor.__MozillaGetInnerText(a,b);AjaxControlToolkit.HTMLEditor.__needLineBreakAfter(a)&&b.write("\n")}}};AjaxControlToolkit.HTMLEditor.__needLineBreakBefore=function(b){var a=" div table p pre ol ul blockquote form fieldset ";return a.indexOf(" "+b.tagName.toLowerCase()+" ")!=-1};AjaxControlToolkit.HTMLEditor.__needLineBreakAfter=function(b){var a=" br div table tr p pre ol ul li hr blockquote form fieldset legend ";return a.indexOf(" "+b.tagName.toLowerCase()+" ")!=-1};AjaxControlToolkit.HTMLEditor.__needTabBefore=function(b){var a=" td li ";return a.indexOf(" "+b.tagName.toLowerCase()+" ")!=-1}}catch(a){};